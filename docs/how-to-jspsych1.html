<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>jsPsychを用いた認知課題の作成1: jsPsychとJavaScript入門 v0.1</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="site_style.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}


.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Computational Clinical Psychology Lab</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="research.html">Research</a>
</li>
<li>
  <a href="team.html">Team</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Publications
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="book.html">書籍</a>
    </li>
    <li>
      <a href="articles.html">学術論文</a>
    </li>
    <li>
      <a href="articles-japanese.html">学術論文（日本語）</a>
    </li>
    <li>
      <a href="bulletin.html">紀要論文</a>
    </li>
    <li>
      <a href="presentation.html">国際会議発表</a>
    </li>
    <li>
      <a href="presentation-japanese.html">国内学会・研究会発表</a>
    </li>
  </ul>
</li>
<li>
  <a href="code_tips.html">Code &amp; Tips</a>
</li>
<li>
  <a href="education.html">Education</a>
</li>
<li>
  <a href="news.html">News</a>
</li>
<li>
  <a href="https://kunisatolab.github.io/english/index.html">English</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">jsPsychを用いた認知課題の作成1: jsPsychとJavaScript入門 v0.1</h1>

</div>


<p>本ページでは，jsPsychを用いた認知課題の作成をRstudioで行う方法について解説をします。本ページでは，以下の内容を解説しています。</p>
<ol style="list-style-type: decimal">
<li>RstudioでjsPsychを使用するまでの準備</li>
<li>こんにちわjsPsych(文字を画面に表示)</li>
<li>JavaScriptの基本</li>
</ol>
<p><br></p>
<div id="jspsych" class="section level2">
<h2>jsPsychとは</h2>
<p>jsPsychとは，ウェブブラウザー（Microsoft Edge,Google Chrome,Safariなど）上で行動実験を行うためのJavaScriptライブラリーです。そもそもJavaScriptを上手く使えば，ウェブブラウザーで動作する行動実験課題は作成できます。しかし，全て一から作っていると大変です。そこで，jsPsychのライブラリーを活用することで，より楽に実験課題を作成することができます。</p>
<p>jsPsychの情報としては，<a href="https://www.jspsych.org/">jsPsychのオフィシャルサイト</a>に豊富にありますし，日本語でも九州大学文学部心理学研究室の黒木大一朗先生の<a href="https://sites.google.com/site/webdeshinri/home">ウェブブラウザで心理学実験と調査jsPsych</a>にて詳細に解説されています<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a>。分からないことがあれば，まず，この２つのサイトを参照すると良いかと思います。RstudioでjsPsychを使う方法は，<a href="https://github.com/CrumpLab/jsPsychR">Matthew Crump氏のGithub</a>を参考ください。</p>
<p>jsPsychは，de Leeuw, J. R. 氏が開発したもので，使用する際には，以下の作成論文を引用するようにしましょう（卒論や修論で何らかのオープンソースソフトウェアを使ったら，必ず作成論文を引用してください）。</p>
<ul>
<li>de Leeuw, J. R. (2015). jsPsych: A JavaScript library for creating behavioral experiments in a web browser. Behavior Research Methods, 47(1), 1-12. <a href="doi:10.3758/s13428-014-0458-y" class="uri">doi:10.3758/s13428-014-0458-y</a>.</li>
</ul>
<p><br></p>
</div>
<div id="jspsych" class="section level2">
<h2>1.jsPsychを使う準備</h2>
<div id="jspsych" class="section level3">
<h3>1.1 jsPsychのダウンロード</h3>
<p>まず，<a href="https://github.com/jspsych/jsPsych/releases">jsPsychのリリースページ</a>にいきます。以下のようなページが出てくるので，Latest releaseのところを見ます（以下の例だとv6.1.0です）。</p>
<p><img src="fig/jspsych1_fig1.png" /></p>
<p>少し下の方にスクロールすると，“jspsych-X.X.X.zip”(以下の場合は，“jspsych-6.1.0.zip”です)というファイルが見えてくるので，それをクリックして，ダウンロードします。</p>
<p><img src="fig/jspsych1_fig2.png" /></p>
<div class="section level4">
<h4>ゼミ生向けの情報</h4>
<p>私のゼミ生の場合は，クラウド上のRstudio serverで作業をします。そのため，jsPsychを直接RStudioに読み込みますので，上記の“jspsych-X.X.X.zip”というファイルを右クリックして，このファイルへのリンクをコピーします（Chromeを使う場合は，右クリックすると以下のように出てきますので，「Copy Link Adress」をクリックください）。</p>
<p><img src="fig/jspsych1_fig3.png" /></p>
</div>
</div>
<div id="jspsych" class="section level3">
<h3>1.2 jsPsych課題用のフォルダの作成</h3>
<p>jsPsychで認知課題を作成する際には，フォルダを作って，そこに使用するファイル一式(jsPsychライブラリ，呈示する刺激，HTML，Rmdファイルなど)を置くようにしましょう。まずは，パソコンの好きな場所に，「hello」という名前のフォルダを作ってください。</p>
<div id="-1" class="section level4">
<h4>ゼミ生向けの情報</h4>
<p>私のゼミ生の場合は，クラウド上のRstudio serverで作業をします。Rstudioの左下のペインの「Files」から「New Folder」をクリックして，出てきた以下のようなウィンドウに「hello」と打ち込んでください。</p>
<p><img src="fig/jspsych1_fig4.png" /></p>
</div>
</div>
<div id="jspsych" class="section level3">
<h3>1.3 jsPsychライブラリの設置</h3>
<p>フォルダができたら，“jspsych-X.X.X.zip”を解凍・展開して，出てきた“jspsych-X.X.X”フォルダをコピーして，さきほどの「hello」フォルダにペーストします。</p>
<div id="-2" class="section level4">
<h4>ゼミ生向けの情報</h4>
<p>私のゼミ生の場合は，クラウド上のRstudio serverで作業をします。必ず以下の手順に従ってください。</p>
<ul>
<li>RStudioを開いて，さきほど作成した「hello」フォルダをワーキングディレクトリーに設定します(Rstudioの上のSession→setWorking Directory→Choose Directory…で選択)。その上で，以下をRStudioのConsole上で実行します。curl &lt;- “XXX”のXXXには，jsPsychのリンクを入れます（1.2でコピーしたものです）。なお，2019年9月の段階でjsPsychの最新が6.1.0ですので，その時の最新のものを使うようにしてください(その都度，URLを変えたり，unzipの展開先名を変えてください)。</li>
</ul>
<pre><code>temp &lt;- tempfile()
curl &lt;- &quot;https://github.com/jspsych/jsPsych/releases/download/v6.1.0/jspsych-6.1.0.zip&quot;
download.file(curl, temp, mode=&quot;wb&quot;) 
unzip (temp, exdir = &quot;./jspsych-6.1.0&quot;)
unlink(temp)</code></pre>
</div>
</div>
<div id="rstudiojspsych" class="section level3">
<h3>1.4 RstudioでjsPsychを使う準備</h3>
<p>本ページでは，RstudioでjsPsychを使います。早速，RStudioを起動しましょう。Rstudioが起動すると以下のような画面かと思います。</p>
<p><img src="fig/jspsych1_fig5.png" /></p>
<p>左上の方の新規ファイル作成（赤い丸で囲っている）をクリックして，「R Markdown…」（青い四角で囲っている）をクリックします。</p>
<p><img src="fig/jspsych1_fig6.png" /></p>
<p>以下のように，なにかウィンドウが出てきますが，そのまま「OK」をクリックします。</p>
<p><img src="fig/jspsych1_fig7.png" /></p>
<p>R Markdownファイルが作成されて，左上のペインにでてきました。とりあえず，hello1.Rmdという名前で保存しておきます（保存マークをクリックすると保存できます）。</p>
<p><img src="fig/jspsych1_fig8.png" /></p>
</div>
<div id="r-markdonjspsych" class="section level3">
<h3>1.5 R MarkdonでjsPsychを扱う</h3>
<p>R Markdon(ファイルの拡張子は.Rmd)は，ざっくり言うと，文章とプログラミングコード（基本的にはRだが，JavaScriptやPyhtonも使える）をまとめてHTMLファイル(インターネットのサイトを作っているファイル)にして出力してくれるものです。R Markdownの詳細については，<a href="https://kazutan.github.io/kazutanR/Rmd_intro.html">Kazutan氏のサイト</a>が非常に勉強になると思います。R Markdownは，解析コードと文章を１つのファイルに読みやすい形でまとめられるので，解析などでも便利なものですが，ここでは，jsPsychを使うために利用します。</p>
</div>
<div id="jspsychrmarkdown" class="section level3">
<h3>1.6 jsPsychを使うときのRMarkdownの設定</h3>
<ul>
<li>1.Rmdのyamlヘッダを以下のように変更します（タイトルは課題名とか，名前は自分や研究グループの名前を記載してください）。このyamlヘッダではインデントが重要ですので，必ず以下のインデントの構造と同じようにしてください。</li>
</ul>
<pre><code>---
title: &quot;タイトル&quot;
author: &quot;名前&quot;
output:
  html_document:
    mathjax: null
    highlight: null
    theme: null
    css: jspsych-X.X.X/css/jspsych.css
---</code></pre>
<ul>
<li>2.最初のチャンク(プログラミングコードの１まとまりのこと)を{r setup, include=FALSE}にして，以下のコードを書きます。これは，rチャンクに書き込まれたコードはHTMLにした時に表示せず(echo = FALSE),メッセージや警告がでてもHTMLに表示しない(message=FALSE, warning=FALSE)ようにすることをデフォルトとして設定しています。</li>
</ul>
<pre><code>knitr::opts_chunk$set(echo = FALSE, message=FALSE, warning=FALSE)</code></pre>
<ul>
<li>3.jsPsychのプラグインの追加をします。チャンクを{r}とした上で，以下のように書きます(追加には，htmltoolsパッケージを使って，tags$script(src=’’)で必要なプラグインなどを指定します)。jsPsychを使う限り’jspsych-6/jspsych.js’は必須ですが，プラグインは，適宜使用するものを追加します（以下の例では，jspsych-html-keyboard-responseというプラグインを追加しています。これは，HTML形式の刺激の呈示とキーボードからの反応を取得するプラグインです）。なお，<a href="https://www.jspsych.org/plugins/overview/">jsPsychのプラグインの概観ページ</a>を確認すると，どういうプラグインがあるか確認できます。</li>
</ul>
<pre><code>library(htmltools)
tagList(
tags$script(src=&#39;jspsych-6/jspsych.js&#39;),
tags$script(src=&#39;jspsych-6/plugins/jspsych-html-keyboard-response.js&#39;)
)</code></pre>
<p>ここまでの設定内容を画像で示すと，以下のような感じです。</p>
<p><img src="fig/jspsych1_fig9.png" /></p>
<ul>
<li>4.jsPsychの本体のコードは，チャンクを{js}とする（このチャンク内でjsPsychを使ったjsコードを書く）。{js}内を書き込んだものを画像で見せると以下のような感じです。なお，まだ{js}内は書かなくても大丈夫です。</li>
</ul>
<p><img src="fig/jspsych1_fig10.png" /></p>
<p>さて，準備が整ってきました。以降では，{js}内にコードを書くことで，実験用のHTMLを作っていきます。</p>
<p><br></p>
</div>
</div>
<div id="jspsych" class="section level2">
<h2>2. こんにちわjsPsych(文字を画面に表示)</h2>
<p>だいたいプログラミングの最初は，「Hello World」とか書くので，今回も「こんにちわあ」と画面に表示させることにします。</p>
<div id="javascript" class="section level3">
<h3>2.1 JavaScriptの書き込み</h3>
<p>先程のRmdの準備の段階で，プラグインなどの準備はできているので，JavaScriptの本体の記載に集中します。以下の画像の{js}チャンクをご自身のRmdファイルに転記してください（コピペだけだと覚えないので・・・）。</p>
<p>コードの内容を説明すると，まずtimelineというものを準備します（これは試行の順番などを指示するものです。timelineに従って課題は進みます。なお，timeline名はtimeline以外の名前でも使えます）。「こんいちわあ」という文字を出すwelcome試行を設定して（プラグインのhtml-keyboard-responseを使用），timelineにプッシュしています（イメージするなら登録ですね）。最後に，jsPsych.initで，timelineに従って実験をするように指定しています。</p>
<p><img src="fig/jspsych1_fig11.png" /></p>
</div>
<div id="rmdhtml" class="section level3">
<h3>2.2 RmdからHTMLファイルを出力する</h3>
<p>Rmdファイルの書き込みが完成したら，以下の緑の丸で囲った「Knit」ボタンをクリックします。これをクリックすると，RmdファイルからHTMLファイル生成されます。HTMLファイルができると，それが別ウィンドウで開かれて，画面上に「こんにちわあ」が呈示されるかと思います。それができたら成功です（上手く行かない場合は，上の画像をよく見て，記入ミスがないか確認してください）。</p>
<p><img src="fig/jspsych1_fig12.png" /></p>
<p><br></p>
<div id="1.1" class="section level4">
<h4>演習課題1.1</h4>
<ul>
<li>「こんにちわあ」の代わりに「こんばんわあ」と画面に表示してみましょう。</li>
</ul>
</div>
</div>
</div>
<div id="javascript" class="section level2">
<h2>3. JavaScriptの基本</h2>
<div id="javascript" class="section level3">
<h3>3.1 JavaScriptで変数と配列を使ってみる</h3>
<p>まず，新規にRmdファイルを作成して，hello1.Rmdの内容をコピペして，hello2.Rmdという名前で保存します。</p>
<p>プログラミングをしていると，変数というのが出てきます。変数は簡単にいうと箱です。箱ですので，好きなものをいれることができます（ただ，箱によっては，入れられるものと入れられないものがあります）。JavaScriptでは，「これが変数だよ」っと宣言する場合には，varを使います。先程のコードだと，var timeline = []というのがありましたが，これは，timelineという変数に，空っぽの配列[]をいれるよという宣言です(配列については後で説明します)。</p>
<p>変数を上手く使うことで効率よくコードが書けるので，少し練習をしてみましょう。さきほどは，“こんにちわあ”という文字を直接指定して画面に出してみましたが，今度は，textという変数に“ニイハオ”という文字をいれて，そのtextを画面に出すようにしてみましょう。以下のコードを書いて実行してください。</p>
<p><img src="fig/jspsych1_fig13.png" /></p>
<p>変数に追加して覚えておくと良いのが配列です。配列は，簡単にいうと，複数の値を変数に格納したものです（箱の中に入っている物が複数ある状態です）。例えば，以下のように書くと，textの中には，“こんにちは”から始まって４つの挨拶が入っていると宣言することになります。</p>
<pre><code>var text = [&quot;こんにちは&quot;,&quot;ニイハオ&quot;,&quot;アニョハセヨ&quot;,&quot;ハロー&quot;]</code></pre>
<p>このtextの中の特定の挨拶を指定したい場合，その配列のインデックスで指定します。難しい言い方をしましたが，配列の何番目か数字で指定するという意味です。その際，その数字は0番目から始まるのに注意します。つまり，上記のtextの場合，text[1]は“ニイハオ”であり，“こんにちは”はtext[0]です。普通だと1番目から数えると思うのに0からスタートするのは忘れないようにしておきましょう（なお，Rだと1からスタートしますし，PythonだとJavaScriptと同じく0からスタートします。ややこしいですね）。</p>
<div id="1.2" class="section level4">
<h4>演習課題1.2</h4>
<ul>
<li>textに“こんにちは”,“ニイハオ”,“アニョハセヨ”,“ハロー”の４つを格納して，“アニョハセヨ”を画面に呈示してください。</li>
</ul>
</div>
</div>
<div id="javascriptfor" class="section level3">
<h3>3.2 JavaScriptでfor文を使ってみる</h3>
<p>3.1で配列を覚えました。その配列の中身４つを順番に呈示したい時，以下のように書くとそれができます。なお，さきほどまでの設定だと，なにかキーボード入力がないと次の刺激に進まないので，stimulusの後ろに“trial_duration: 1000,”を追加しています。これは刺激を1000ms(1000ミリ秒つまり1秒)呈示するという意味です。</p>
<pre><code>    /* タイムラインを用意 */
    var timeline = [];
    /* 呈示する文字を変数にする */
    var text = [&quot;こんにちは&quot;,&quot;ニイハオ&quot;,&quot;アニョハセヨ&quot;,&quot;ハロー&quot;]
    /* trialで呈示する文字を設定 配列[0] */
    var welcome = {
      type: &quot;html-keyboard-response&quot;,
      stimulus: text[0],
      trial_duration: 1000
    };
    timeline.push(welcome);
    /* trialで呈示する文字を設定 配列[1]*/
    var welcome = {
      type: &quot;html-keyboard-response&quot;,
      stimulus: text[1],
      trial_duration: 1000
    };
    timeline.push(welcome);
    /* trialで呈示する文字を設定 配列[2]*/
    var welcome = {
      type: &quot;html-keyboard-response&quot;,
      stimulus: text[2],
      trial_duration: 1000
    };
    timeline.push(welcome);
    /* trialで呈示する文字を設定 配列[3]*/
    var welcome = {
      type: &quot;html-keyboard-response&quot;,
      stimulus: text[3],
      trial_duration: 1000
    };
    timeline.push(welcome);
    /* 実験開始 */
    jsPsych.init({
      timeline: timeline
    });</code></pre>
<p>これでもいいのですが，配列のインデックス以外同じコードが４回も繰り返されており，なんという無駄が多いように感じます。単純に繰り替えているだけですので，こういう場合は，繰り返し作業のためのfor文というのを使います。</p>
<p>for文は以下のように書いて，繰り返したい内容をfor(){　 }で囲みます。そいて，for()の()内で，いつから初めていつ繰り返しをやめるのかを設定します。var i = 0; i&lt;4; i++とすると，0からはじまって3まで繰り返します(それぞれ繰り返すたびにその値がiに代入されます)。var i = 3; i&lt;6; i++とすると，3からはじまって5まで繰り返します。</p>
<pre><code>for (var i = 0; i&lt;終了したい数+1; i++) {
  // 繰り返したい内容
}</code></pre>
<p>for文が分かったところで，さきほどの配列の中身４つを呈示するのは，以下のように書くことができます。for文で書くとすっきりしますね。さて，for文で書いたものを動かしてみましょう。</p>
<p><img src="fig/jspsych1_fig14.png" /></p>
<div id="1.3" class="section level4">
<h4>演習課題1.3</h4>
<ul>
<li>色々な国の挨拶を８カ国分用意して，for文で8カ国分の挨拶を呈示してみましょう！</li>
</ul>
</div>
</div>
<div id="javascriptif" class="section level3">
<h3>3.3 JavaScriptでif文を使ってみる</h3>
<p>3.2では繰り返しのfor文を覚えました。あとは分岐のif文を覚えれば基礎は終了です。</p>
<p>for文は同じ内容を繰り返す場合に使います。そのため，ほぼ同じ内容だけど，少しだけ違う場合には使えないです。例えば，for文のインデックスが奇数の場合は配列Aから刺激を出して，偶数の場合は配列Bから刺激を出すというのは単純なfor文だとちょっと難しい。こういう時に条件分岐のif文を使えると簡単にプログラミングできます。</p>
<p>if文は以下のように書きます。if()の()内に条件文を書き，その条件に合致していれば{}内の処理がなされます。もしその後に，else if()やelse()が続くなら，最初のif()に合致しない場合に，その後の条件にあれはれば，その{}内の処理がなされます。なお，if()は最初だけで，その後はelse if()が続き，最後は上記以外を意味するelse()を使います。ただ，if()だけで終わることもあります。</p>
<pre><code>if (条件1) {
  条件1が真であれば実行
} else if (条件2) {
  条件1が偽で条件2が真であれば実行
}
else {
  条件1も2も偽であれば実行
}</code></pre>
<p>具体例として，BMIから「やせ」，「普通」，「肥満」を判定する場合を考えます。この場合，if文は以下のようにかけます。最初のif()は「BMIが18.5より低いなら“やせ”とする」という意味です。次のelse if文は，「BMIが18.5以上25未満なら“普通”とする」という意味です。なお，このようにAかつBを表現するには&amp;&amp;を使い，AまたはBを表現するには||を使います。</p>
<ul>
<li>A || B ←A OR B(AまたはB)</li>
<li>A &amp;&amp; B ←A AND B(AかつB)</li>
</ul>
<p>最後のelse()は，「上記以外のBMIなら（つまりは25以上なら）“肥満”とする」という意味です。こんな感じでif文なら条件分岐を表現できます。</p>
<pre><code>if (BMI &lt; 18.5) {
  var himan = &quot;やせ&quot; 
} else if (BMI &gt;=18.5 &amp;&amp; BMI &lt; 25) {
  var himan = &quot;普通&quot; 
}
else {
  var himan = &quot;肥満&quot; 
}</code></pre>
<p>さて，本題に戻って，以下のように，「こんにちは」の配列のtext1と「こんばんは」の配列のtext2を用意します。そして，for文のindexが偶数(ここでは0か2です)ならtext1を，奇数ならtext2を呈示してみましょう。</p>
<p><img src="fig/jspsych1_fig15.png" /></p>
<div id="1.4" class="section level4">
<h4>演習課題1.4</h4>
<ul>
<li>「こんにちは」の配列のtext1と「こんばんは」の配列のtext2にそれぞれ２つ足して，要素を６つにします。さらに，各国の「おはようございます」が６つ入った配列を追加して(text3としますか)，色々な国の挨拶を朝・昼・晩と順番に6回呈示してみましょう！<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a></li>
</ul>
</div>
</div>
</div>
<div class="footnotes">
<hr />
<ol>
<li id="fn1"><p>本ページを作る際に，黒木先生のサイトをかなり参考にさせていただきました。特に，必要最小限のJavaScriptの知識について大変参考になりました。<a href="#fnref1" class="footnote-back">↩</a></p></li>
<li id="fn2"><p>時間が余った人は，演習課題1.4で３つの配列を順番に呈示した際に配列には４つ入っているのに全て使ってないことに気がついたと思います。全て使い切るにはどうすればよいでしょうか？考えて，試してみましょう。<a href="#fnref2" class="footnote-back">↩</a></p></li>
</ol>
</div>

<footer>
  <p>Copyright &copy; 2019 Yoshihiko Kunisato. All rights reserved </p>
</footer>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
